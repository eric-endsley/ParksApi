# Parks API

#### An API storing information regarding U.S. state and national parks, 1/22/21

#### By Eric Endsley

## Description

This is an API developed in C# which contains information regarding the name of State Parks & National Parks, as well as the states in which the parks are located. Information for state parks and national parks are located at separate endpoints. Both state and national park endpoints accept GET, POST, PUT and DELETE calls. GET calls can query an entire national park or state park dataset, or can be searched by a specific state using the optional state parameter. POST calls post a new park to either the national or state park dataset, requiring both a park name and a home state in the call body. PUT calls modify the information for a single park in either dataset, which must be specified by it's id in the url of the API call. DELETE calls delete a single park from either dataset and are targetted identically to PUT calls.

This application has autogenerated API documentation on a Swagger page which can be located at the localhost url where the API is hosted + '/swagger'. Typically this will be at 'http://localhost:5000/swagger', which details the API endpoints and call types. This application also utilizes authentication with JWS tokens. Since this is a school project, the authentication is only a demonstration of concept as there is no option to register. As such the database of users is hardcoded as "Username": "username", "Password: "password". Further information on this will be listed in the setup, but a successful post query to the 'users/authenticate' endpoint will return a body with a Token parameter followed by a long string which must be used as a Bearer Token in the authorization field to successfully make all other API calls. Without the JWS token in place, any other API call will return a 401 unauthorized error.

## Setup

### Install .NET Core

1. This program is written in C# and requires the .NET Core to run. For PC users click [this link](https://dotnet.microsoft.com/download/dotnet-core/thank-you/sdk-2.2.203-windows-x64-installer) and follow the installation instructions. For Mac users click [this link](https://dotnet.microsoft.com/download/dotnet-core/thank-you/sdk-2.2.106-macos-x64-installer) and follow the installation instructions.

2. Install dotnet script by entering the following command in your terminal: "dotnet tool install -g dotnet-script"

### Install MySQL

1. This program uses MySQL to store and manage data. Navigate to [this link](https://dev.mysql.com/downloads/file/?id=484919) and follow the installation instructions to install MySQL and MySQL Workbench.

2. Be sure to make note of the password you create during the installation process, you will need to use this later on in the setup.

### Install Postman

1. In order to make API calls, it is recommended that you use the application Postman. Navigate to the [this link](https://www.postman.com/downloads/) and follow the installation instructions.

### Clone The Repository

1.  Open the [Parks Api website](https://github.com/eric-endsley/ParksApi.git) by clicking the link or copy/pasting "https://github.com/eric-endsley/ParksApi.git" in the navigator bar of a web browser application.

2.  Click the green Code button in the upper-right part of the window and then EITHER:

3.  a. Copy the HTTPS URL for the repo and use it in the git clone command in git-bash or another git terminal by inputting: "git clone https://github.com/eric-endsley/ParksApi.git"<br>
    OR b. Click "Download Zip" and unzip the file to an accessible location on your machine.

4.  Right click on the project directory and open it with VS Code or another code editor.

### Setup MySQL Database with Entity

#### Option 1: Create Data Structure Code First From the Terminal:

1. Navigate to the appsettings.json file within the /ParksApi subdirectory. Locate the line of code that states "pwd=epicodus" and overwrite epicodus with the password you created during installation of MySQL

2. In your terminal, type the command "dotnet restore" followed by the command "dotnet ef database update". You have now created the data structure for this application.

#### Option 2: Import Data Structure Using MySQL Workbench GUI:

1. Open the program MySQL Workbench which you installed earlier and enter the password that you setup during installation.

2. Using the navigation bar select Server > Data Import.

3. When prompted, select the option to "Import From Self Contained File" and select the file "parks_Db_export.sql" in the Factory.Solution folder.

4. In the dropdown labelled "Default Target Schema:", select "parks" or whatever you named your database in appsettings.json. Select all of the schema objects. Then click the "Start Import" button. You have now imported the data structure.

### Run the API Server & Make API Calls in Postman

1. In the terminal, type the command "dotnet run".

2. Open the Postman application you installed earlier. In the URL input field beneath "Untitled Request" in the Postman window, enter the address of your local server. This will typically be 'http://localhost:5000/', but may be different. To confirm, find the url written after "Now listening on:" in your terminal below the "dotnet run" command.

You may now make API calls by appending routes to your localhost address as directed in the API Documentation section.

## API Documentation

### Authentication

This API utilizes authentication with JWS tokens. You do not need to register a username or password, the username and password are hardcoded in the UserService. Follow the instructions below to authenticate before making API calls:

1. In the drop down form to the left of the URL input field in Postman select POST.

2. In the URL input field, enter your localhost name appended with '/users/authenticate'

3. In the body field of your post request, enter the following hardcoded user information exactly:

```
{
  "Username": "username",
  "Password": "password",
}
```

4. In the body of the API response, there should be a parameter called "token". Copy the string of characters listed in the field of this parameter, it should look like this:

```
{
    "id": 1,
    "username": "username",
    "password": null,
    "token": "<COPY-THIS-STRING>"
}
```

5. Click on the authorization tab listed directly beneath the URL input field in Postman. In the dropdown list here select "Bearer Token". In the Token field to the right, paste the token string that you copied from the API response. You are now authorized to make calls to the API!

### Swagger

All endpoints discussed in this section are listed on the API's Swagger page. This can be found by navigating to 'http://localhost:<your-local-host-port>/swagger'.

To use an endpoint simply append the route listed in the swagger documentation (e.g. /api/NatlParks) to your local host address in the Postman URL input field and select the corresponding API Call type from the dropdown menu (e.g. GET).

Make sure to include all required parameters as listed in the Swagger documentation.

### Endpoints Warranting Clarification

- POST calls to either the /api/natlparks or /api/stateparks endpoint require a JSON body which _must_ include a name and state, formatted as below:

```
{
    "name": "<PARK-NAME-HERE>,
    "state": "<PARK-STATE-HERE>"
}
```

An ID field may be included, but is not recommended, as the ID property is set to autoincrement which will keep the IDs consistent.

## Technologies Used

C#, .NET Core 2.2, ASP.NET Core MVC, MySQL, Entity Framework Core, Razor, Bootstrap, VS Code, Postman, Swagger, NSwag

## Known Bugs

None

## Contact Information

To ask questions or report a bug, contact [Eric Endsley](mailto:eric.endsley4@gmail.com)

## Legal

This software is licensed under the MIT license.

```

```
